## 串口输入格式说明文档

本文档描述了用于控制基于STM32的机器人平台的串口输入格式。通信任务解析通过UART接收的命令并执行相应的操作。

### 1. 电机速度控制命令 (`$SPD`)

该命令用于设置各个电机的目标速度。

**格式:**

```
$SPD,speed0,speed1,speed2,speed3#
```

*   `$SPD`: 命令标识符。
*   `speed0`, `speed1`, `speed2`, `speed3`: 分别表示电机0、1、2和3的目标速度。这些是表示所需速度（RPM）的整数值。负值表示反向。
*   `#`: 井号字符，表示命令结束。

**示例:**

要将电机0设置为50 RPM，电机1设置为-30 RPM，电机2设置为0 RPM，电机3设置为80 RPM，应发送以下命令：

```
$SPD,50,-30,0,80#
```

**响应:**

在接收并处理`$SPD`命令后，系统将为每个电机发送确认消息：

```
ACK,M0,50
ACK,M1,-30
ACK,M2,0
ACK,M3,80
```

*   `ACK`: 确认标识符。
*   `M0`, `M1`, `M2`, `M3`: 电机标识符。
*   `50`, `-30`, `0`, `80`: 为相应电机设置的目标速度。

### 2. PID参数控制命令 (`$PID`)

该命令用于设置各个电机的PID（比例、积分、微分）参数。

**格式:**

```
$PID,motorId,Kp,Ki,Kd#
```

*   `$PID`: 命令标识符。
*   `motorId`: 要配置的电机的ID（0-3）。
*   `Kp`: 比例增益。浮点值。
*   `Ki`: 积分增益。浮点值。
*   `Kd`: 微分增益。浮点值。
*   `#`: 井号字符，表示命令结束。

**示例:**

要将电机1的PID参数设置为Kp=0.5，Ki=0.1，Kd=0.01，应发送以下命令：

```
$PID,1,0.5,0.1,0.01#
```

**响应:**

在接收并处理`$PID`命令后，系统将发送确认消息：

```
PID,M1,0.50,0.10,0.01
```

*   `PID`: 确认标识符。
*   `M1`: 电机标识符。
*   `0.50`, `0.10`, `0.01`: 为相应电机设置的PID参数。

### 3. 舵机角度控制命令 (`$SRV`)

该命令用于设置指定舵机的角度位置。

**格式:**

```
$SRV,servoId,angle#
```

*   `$SRV`: 命令标识符。
*   `servoId`: 要控制的舵机的ID（0-7）。
*   `angle`: 目标角度，范围从0到180度的浮点值。
*   `#`: 井号字符，表示命令结束。

**示例:**

要将舵机2的角度设置为45度，应发送以下命令：

```
$SRV,2,45#
```

**响应:**

在接收并处理`$SRV`命令后，系统将发送确认消息：

```
SRV,S2,45.0
```

*   `SRV`: 确认标识符。
*   `S2`: 舵机标识符。
*   `45.0`: 设置的目标角度（度）。

### 注意事项:

*   所有命令区分大小写。
*   参数之间的分隔符是逗号（`,`）。
*   命令必须以井号（`#`）结束。
*   格式错误的命令将被忽略。
*   确保参数的数据类型与预期类型（整数或浮点数）匹配。
*   舵机角度范围为0-180度，超出此范围的值将被限制在有效范围内。
*   电机速度的单位为RPM（每分钟转数）。